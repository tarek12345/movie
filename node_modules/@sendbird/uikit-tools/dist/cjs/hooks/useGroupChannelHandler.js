"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useGroupChannelHandler = void 0;
const react_1 = require("react");
const groupChannel_1 = require("@sendbird/chat/groupChannel");
const useUniqId_js_1 = require("./useUniqId.js");
const useGroupChannelHandler = (sdk, hookHandler, handlerId) => {
    const handlerRef = (0, react_1.useRef)(hookHandler);
    const id = (0, useUniqId_js_1.useUniqId)();
    const internalHandlerId = handlerId !== null && handlerId !== void 0 ? handlerId : id;
    handlerRef.current = hookHandler;
    (0, react_1.useEffect)(() => {
        var _a;
        const handlerMapper = (handler) => {
            const handlerKeys = Object.keys(handler);
            handlerKeys.forEach((key) => {
                // @ts-ignore
                handler[key] = (...args) => { var _a, _b; return (_b = (_a = handlerRef.current) === null || _a === void 0 ? void 0 : _a[key]) === null || _b === void 0 ? void 0 : _b.call(_a, ...args); };
            });
            return handler;
        };
        (_a = sdk === null || sdk === void 0 ? void 0 : sdk.groupChannel) === null || _a === void 0 ? void 0 : _a.addGroupChannelHandler(internalHandlerId, handlerMapper(new groupChannel_1.GroupChannelHandler()));
        return () => {
            var _a;
            (_a = sdk === null || sdk === void 0 ? void 0 : sdk.groupChannel) === null || _a === void 0 ? void 0 : _a.removeGroupChannelHandler(internalHandlerId);
        };
    }, [sdk === null || sdk === void 0 ? void 0 : sdk.groupChannel, internalHandlerId]);
};
exports.useGroupChannelHandler = useGroupChannelHandler;
